/* ========================================================== */
/* ETAPA 1: ÁTOMOS (TOKENS PRIMITIVOS) */
/* ========================================================== */
/*
 * A "paleta" central. Valores brutos, sem propósito.
 * Esta é a única seção que você edita para "testar"
 * novas fontes, cores ou espaçamentos.
*/
:root {
  /* --- Átomos de Cor: Marca --- */
  --color-brand-primary: #ff7a00;
  --color-brand-secondary: #0b57d0;

  /* --- Átomos de Cor: Feedback --- */
  --color-accent-green: #16a34a;
  --color-danger-red: #dc2626;
  --color-warning-yellow: #f59e0b;
  --color-info-cyan: #0284c7;

  /* --- Átomos de Tom: Modo Claro (Light) --- */
  --color-light-bg: #f7f9fb;
  --color-light-surface: #ffffff;
  --color-light-surface-alt: #f1f5f9;
  --color-light-border: #e2e8f0;
  --color-light-text-primary: #0f172a;
  --color-light-text-muted: #64748b;
  --color-light-text-muted-strong: #475569;
  --color-light-solid: #ffffff;

  /* --- Átomos de Tom: Modo Escuro (Dark) --- */
  --color-dark-bg: #0b1220;
  --color-dark-surface: #0f172a;
  --color-dark-surface-alt: #111a2d;
  --color-dark-border: #1f2a44;
  --color-dark-text-primary: #e5efff;
  --color-dark-text-muted: #8aa0bd;
  --color-dark-text-muted-strong: #b7c4d8;
  --color-dark-solid: #ffffff;

  /* --- Átomos de Raio (T-Shirt Sizing) --- */
  --radius-s: 6px;
  --radius-m: 10px;
  --radius-l: 14px;
  --radius-xl: 24px;
  --radius-pill: 9999px;
  --radius-circle: 50%;

  /* --- Átomos de Espaçamento (Escala de Ritmo) --- */
  /* (Numerais são a "melhor prática" para escalas) */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-7: 32px;
  --space-8: 48px;

  /* --- Átomos de Tipografia (Fontes) --- */
  --font-family-ui: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", sans-serif;
  --font-family-emoji: "Segoe UI Emoji", "Apple Color Emoji", "Noto Color Emoji", sans-serif;

  /* --- Átomos de Tipografia (Tamanhos) --- */
  --font-size-xs: 11px;
  --font-size-s: 12px;
  --font-size-base: 14px;
  --font-size-m: 15px;
  --font-size-l: 16px;
  --font-size-xl: 22px;
  --font-size-2xl: 28px;
  --font-size-3xl: 36px;
  
  /* --- Átomos de Tipografia (Peso) --- */
  --font-weight-regular: 400;
  --font-weight-medium: 600;
  --font-weight-bold: 700;

  /* --- Átomos de Efeitos (Sombras) --- */
  --shadow-s: 0 1px 2px rgba(15, 23, 42, 0.04), 0 1px 1px rgba(15, 23, 42, 0.04);
  --shadow-m: 0 6px 16px rgba(2, 6, 23, 0.06);
  --shadow-l: 0 18px 40px rgba(15, 23, 42, 0.08);

  /* --- Átomos de Efeitos (Foco) --- */
  --ring-focus: 0 0 0 3px color-mix(in oklab, var(--color-brand-primary) 28%, transparent);

  /* --- Átomos de Tamanho (Larguras de Contêiner) --- */
  --size-container-max-width: 1280px;
  --size-modal-width-default: 760px;
  --size-modal-width-compact: 520px;
  --size-grid-column-min: 300px;
  
  /* --- Átomos de Borda/Linha --- */
  --border-width-1: 1px;
  --border-style-solid: solid;
  --border-style-dashed: dashed;

  /* ========================================================== */
  /* ETAPA 2: MOLÉCULAS (TOKENS SEMÂNTICOS) */
  /* ========================================================== */
  /*
  * A "camada de decisão" (Modo Claro Padrão).
  * Damos "nomes de propósito" (ex: --card-background)
  * e atribuímos a eles um "Átomo".
  */

  /* --- Semântica de Superfície e Fundo --- */
  --background-page: var(--color-light-bg);
  --background-surface-default: var(--color-light-surface);
  --background-surface-alternate: var(--color-light-surface-alt);
  --border-color-default: var(--color-light-border);
  --page-gradient-default: linear-gradient(180deg, color-mix(in oklab, var(--background-surface-alternate) 70%, #ffffff) 0%, var(--background-surface-default) 45%, color-mix(in oklab, var(--background-page) 92%, #ffffff) 100%);

  /* --- Semântica de Borda --- */
  --border-default: var(--border-width-1) var(--border-style-solid) var(--border-color-default);
  --border-dashed: var(--border-width-1) var(--border-style-dashed) var(--border-color-default);

  /* --- Semântica de Texto --- */
  --text-color-primary: var(--color-light-text-primary);
  --text-color-muted: var(--color-light-text-muted);
  --text-color-form-label: var(--color-light-text-muted-strong);
  --text-color-on-primary: var(--color-light-solid);
  --text-color-emphasis: var(--color-brand-secondary);

  /* --- Semântica de Layout --- */
  --layout-container-width: var(--size-container-max-width);
  --layout-grid-columns: repeat(auto-fit, minmax(var(--size-grid-column-min), 1fr));

  /* --- Semântica de Componente: Header --- */
  --header-background: var(--background-surface-default);
  --header-radius: var(--radius-xl);
  --header-shadow: var(--shadow-l);
  --header-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--border-color-default) 70%, transparent);

  /* --- Semântica de Componente: Card & KPI --- */
  --card-background: var(--background-surface-default);
  --card-padding: var(--space-5);
  --card-radius: var(--radius-l);
  --card-shadow: var(--shadow-m);
  --card-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--border-color-default) 60%, transparent);

  /* --- Semântica de Componente: Modal (.sheet) --- */
  --modal-background: var(--background-surface-default);
  --modal-shadow: var(--shadow-m);
  --modal-radius: var(--radius-l);
  --modal-border: var(--border-default);
  --modal-backdrop-background: rgba(2, 6, 23, 0.45);
  --modal-width-default: var(--size-modal-width-default);
  --modal-width-compact: var(--size-modal-width-compact);

  /* --- Semântica de Componente: Botão Padrão (.btn) --- */
  --button-radius: var(--radius-pill);
  --button-shadow: var(--shadow-s);
  --button-padding-y: var(--space-3);
  --button-padding-x: var(--space-5);
  --button-font-weight: var(--font-weight-medium);
  --button-border-default: var(--border-default);
  --button-background-default: var(--background-surface-default);
  --button-color-default: var(--text-color-primary);

  /* --- Semântica de Componente: Botão Primário (.btn.primary) --- */
  --button-primary-background: var(--color-brand-secondary);
  --button-primary-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-brand-secondary) 40%, var(--border-color-default));
  --button-primary-text: var(--text-color-on-primary);

  /* --- Semântica de Componente: Botão Fantasma (.btn.ghost) --- */
  --button-ghost-background: transparent;
  --button-ghost-border: var(--border-dashed);
  --button-ghost-text: var(--text-color-muted);

  /* --- Semântica de Componente: Chip (.chipbtn) --- */
  --chip-padding-y: var(--space-3);
  --chip-padding-x: var(--space-4);
  --chip-radius: var(--radius-pill);
  --chip-border: var(--border-default);
  --chip-background: var(--background-surface-default);
  --chip-font-weight: var(--font-weight-medium);

  /* --- Semântica de Componente: Tag (.tag) --- */
  --tag-background: var(--background-surface-alternate);
  --tag-border: var(--border-default);
  --tag-text: var(--text-color-muted-strong);
  --tag-radius: var(--radius-pill);
  --tag-padding: var(--space-1) var(--space-2);
  --tag-font-size: var(--font-size-xs);

  /* --- Semântica de Componente: Tag Primária (.tag.primary) --- */
  --tag-primary-background: color-mix(in oklab, var(--color-brand-secondary) 12%, var(--background-surface-default));
  --tag-primary-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-brand-secondary) 32%, var(--border-color-default));
  --tag-primary-text: var(--color-brand-secondary);

  /* --- Semântica de Componente: Pill (Feedback) --- */
  --pill-radius: var(--radius-pill);
  --pill-font-size: var(--font-size-s);
  --pill-padding: var(--space-2) var(--space-3);
  /* .pill.warn (Amarelo) */
  --pill-warn-background: color-mix(in oklab, var(--color-warning-yellow) 10%, var(--background-surface-default));
  --pill-warn-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-warning-yellow) 50%, var(--border-color-default));
  --pill-warn-text: var(--color-warning-yellow);
  /* .pill.info (Azul) */
  --pill-info-background: color-mix(in oklab, var(--color-info-cyan) 8%, var(--background-surface-default));
  --pill-info-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-info-cyan) 40%, var(--border-color-default));
  --pill-info-text: var(--color-info-cyan);

  /* --- Semântica de Efeitos --- */
  --focus-ring: var(--ring-focus);
}

/* ========================================================== */
/* ETAPA 2.5: MOLÉCULAS (SUBSTITUIÇÕES MODO ESCURO) */
/* ========================================================== */
[data-theme="dark"] {
  /* --- Semântica de Superfície (Overrides) --- */
  --background-page: var(--color-dark-bg);
  --background-surface-default: var(--color-dark-surface);
  --background-surface-alternate: var(--color-dark-surface-alt);
  --border-color-default: var(--color-dark-border);
  --page-gradient-default: var(--background-page);

  /* --- Semântica de Borda (Overrides) --- */
  --border-default: var(--border-width-1) var(--border-style-solid) var(--border-color-default);
  --border-dashed: var(--border-width-1) var(--border-style-dashed) var(--border-color-default);

  /* --- Semântica de Texto (Overrides) --- */
  --text-color-primary: var(--color-dark-text-primary);
  --text-color-muted: var(--color-dark-text-muted);
  --text-color-form-label: var(--color-dark-muted-strong);
  --text-color-on-primary: var(--color-dark-solid);

  /* --- Semântica de Componente (Overrides) --- */
  --header-shadow: none;
  --card-shadow: none;
  --modal-shadow: none;
  --button-shadow: none;

  /* --- Semântica de Tag Primária (Overrides) --- */
  --tag-primary-background: color-mix(in oklab, var(--color-brand-secondary) 12%, var(--background-surface-default));
  --tag-primary-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-brand-secondary) 32%, var(--border-color-default));

  /* --- Semântica de Pill (Overrides) --- */
  --pill-warn-background: color-mix(in oklab, var(--color-warning-yellow) 10%, var(--background-surface-default));
  --pill-warn-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-warning-yellow) 50%, var(--border-color-default));
  --pill-info-background: color-mix(in oklab, var(--color-info-cyan) 8%, var(--background-surface-default));
  --pill-info-border: var(--border-width-1) var(--border-style-solid) color-mix(in oklab, var(--color-info-cyan) 40%, var(--border-color-default));
}

/* ========================================================== */
/* ETAPA 3: ORGANISMOS (COMPOSIÇÃO 100% "BURRA") */
/* ========================================================== */
/*
 * Os componentes consomem APENAS as Moléculas (Tokens Semânticos).
 * Nenhum valor "mágico" (ex: 1px, 16px, #fff) é permitido aqui.
 * (A única exceção é o '0' para resets).
*/

/* --- Reset Mínimo e Base --- */
* {
  box-sizing: border-box;
}
html,
body {
  height: 100%;
}
body {
  margin: 0;
  background: var(--page-gradient-default);
  color: var(--text-color-primary);
  font-family: var(--font-family-ui);
  font-size: var(--font-size-base);
  line-height: 1.45;
  padding-bottom: var(--space-7);
}
img {
  max-width: 100%;
  display: block;
}
a {
  color: inherit;
  text-decoration: none;
}
:focus-visible {
  outline: none;
  box-shadow: var(--focus-ring);
}

/* --- Ícones (Símbolos do Google) --- */
/* (Carregue a fonte no <head> do seu HTML) */
.material-symbols-rounded {
  font-family: "Material Symbols Rounded";
  font-weight: normal;
  font-style: normal;
  font-size: 24px; /* Padrão, pode ser sobrescrito */
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased;
  /* (Ajustes de variação de fonte podem ser Tokens!) */
  font-variation-settings:
    'FILL' 0,
    'wght' 400,
    'GRAD' 0,
    'opsz' 24;
}

/* --- Organismo: Header --- */
header {
  display: flex;
  flex-direction: column;
  max-width: var(--layout-container-width);
  margin: var(--space-8) auto 0;
  background: var(--header-background);
  border-radius: var(--header-radius);
  box-shadow: var(--header-shadow);
  border: var(--header-border);
  padding: var(--space-7);
  gap: var(--space-6);
}

/* --- Organismo: Toolbar (dentro do Header) --- */
.toolbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: var(--background-surface-alternate);
  border: var(--border-default);
  border-radius: var(--radius-l);
  padding: var(--space-4);
  gap: var(--space-4);
}

/* --- Organismo de Layout: Grid de KPIs e Cards --- */
.kpi-bar,
.grid {
  display: grid;
  grid-template-columns: var(--layout-grid-columns);
  max-width: var(--layout-container-width);
  margin: var(--space-7) auto 0;
  padding: 0 var(--space-5);
  gap: var(--space-6);
}

/* --- Organismo: KPI (Card de Métrica) --- */
.kpi {
  display: flex;
  flex-direction: column;
  position: relative;
  background: var(--card-background);
  border-radius: var(--card-radius);
  box-shadow: var(--card-shadow);
  border: var(--card-border);
  padding: var(--card-padding);
  gap: var(--space-2);
}

/* Título (h3) dentro de um KPI ou Card */
.kpi h3,
.card h3 {
  margin: 0;
  display: flex;
  align-items: center;
  gap: var(--space-2);
  color: var(--text-color-emphasis);
  font-size: var(--font-size-l);
}

/* --- Organismo: Card (Card de Gráfico) --- */
.card {
  display: flex;
  flex-direction: column;
  position: relative;
  background: var(--card-background);
  border-radius: var(--card-radius);
  box-shadow: var(--card-shadow);
  border: var(--card-border);
  padding: var(--card-padding);
  gap: var(--space-4);
}

/* --- Organismo: Modal (Janela) --- */
.modal {
  position: fixed;
  inset: 0;
  display: flex; /* (JS controla para 'none') */
  align-items: center;
  justify-content: center;
  padding: var(--space-6);
  z-index: 100;
}
.modal .backdrop {
  position: fixed;
  inset: 0;
  background: var(--modal-backdrop-background);
  z-index: 0;
}
.modal .sheet {
  position: relative;
  display: flex;
  flex-direction: column;
  z-index: 1;
  background: var(--modal-background);
  border-radius: var(--modal-radius);
  box-shadow: var(--modal-shadow);
  border: var(--modal-border);
  width: var(--modal-width-default);
  max-height: 90vh;
}
.modal .sheet.compact {
  width: var(--modal-width-compact);
}
.modal .sheet-head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-4);
  border-bottom: var(--border-default);
}
.modal .sheet-head h2 {
  margin: 0;
  font-size: var(--font-size-l);
}
.modal .sheet-body {
  padding: var(--space-5);
  overflow-y: auto;
}
.modal .close {
  /* (Estilos do botão de fechar) */
}

/* --- Molécula: Botão Padrão (.btn) --- */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  cursor: pointer;
  font-weight: var(--button-font-weight);
  padding: var(--button-padding-y) var(--button-padding-x);
  border-radius: var(--button-radius);
  box-shadow: var(--button-shadow);
  border: var(--button-border-default);
  background: var(--button-background-default);
  color: var(--button-color-default);
  transition: all 180ms ease;
}
.btn:hover {
  background: var(--background-surface-alternate);
  box-shadow: var(--shadow-m);
  transform: translateY(-1px);
}

/* COMPOSIÇÃO: Variante Primária */
.btn.primary {
  background: var(--button-primary-background);
  border: var(--button-primary-border);
  color: var(--button-primary-text);
}

/* COMPOSIÇÃO: Variante Fantasma */
.btn.ghost {
  background: var(--button-ghost-background);
  border: var(--button-ghost-border);
  color: var(--button-ghost-text);
  box-shadow: none;
}
.btn.ghost:hover {
  background: var(--background-surface-alternate);
  transform: none;
}

/* --- Molécula: Botão Chip (.chipbtn) --- */
.chipbtn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  cursor: pointer;
  font-weight: var(--chip-font-weight);
  padding: var(--chip-padding-y) var(--chip-padding-x);
  border-radius: var(--chip-radius);
  border: var(--chip-border);
  background: var(--chip-background);
  transition: all 180ms ease;
}
.chipbtn:hover {
  background: var(--background-surface-alternate);
  box-shadow: var(--shadow-s);
}

/* --- Molécula: Campo de Formulário (.form-field) --- */
.form-field {
  display: flex;
  flex-direction: column;
}
.form-field label {
  margin-bottom: var(--space-2);
  font-weight: var(--font-weight-medium);
  color: var(--text-color-form-label);
}
.form-field select {
  width: 100%;
  padding: var(--space-3);
  background: var(--background-surface-alternate);
  border: var(--border-default);
  border-radius: var(--radius-m);
  color: var(--text-color-primary);
}

/* --- Molécula: Pill (Aviso) --- */
.pill {
  display: inline-flex;
  align-items: center;
  gap: var(--space-2);
  padding: var(--pill-padding);
  border-radius: var(--pill-radius);
  font-size: var(--pill-font-size);
}
.pill.warn {
  background: var(--pill-warn-background);
  border: var(--pill-warn-border);
  color: var(--pill-warn-text);
}
.pill.info {
  background: var(--pill-info-background);
  border: var(--pill-info-border);
  color: var(--pill-info-text);
}

/* --- Molécula: Tag --- */
.tag {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--tag-padding);
  font-size: var(--tag-font-size);
  background: var(--tag-background);
  border: var(--tag-border);
  color: var(--tag-text);
  border-radius: var(--tag-radius);
}
.tag.primary {
  background: var(--tag-primary-background);
  border: var(--tag-primary-border);
  color: var(--tag-primary-text);
}

/* --- Molécula: Item de Lista (ex: .study-item) --- */
.study-item {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
  padding: var(--space-4);
  border-radius: var(--radius-m);
  background: var(--background-surface-default);
  border: var(--border-default);
  box-shadow: var(--shadow-s);
}

/* --- Utilitários (ex: .hint, .meta) --- */
.hint,
.meta {
  color: var(--text-color-muted);
  font-size: var(--font-size-s);
}
