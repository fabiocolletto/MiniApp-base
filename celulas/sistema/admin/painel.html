<!-- salvar em: celulas/sistema/admin/painel.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin – Visualização</title>

  <!-- Dexie -->
  <script src="https://unpkg.com/dexie/dist/dexie.js"></script>

  <style>
    body { font-family: sans-serif; padding: 20px; background: #f3f4f6; }
    .card { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 4px 16px rgba(0,0,0,0.1); }
    h1 { margin-top: 0; }
    .item { padding: 12px 0; border-bottom: 1px solid #e5e7eb; }
    .item:last-child { border-bottom: none; }
    .label { font-weight: bold; color: #334155; }
    .empty { color: #6b7280; }
  </style>

  <script>
    const db = new Dexie('pwao_admin');
    db.version(1).stores({ admin: '++id,nome,email' });

    // Registrar a célula no organismo PWAO
    (function registrarCelula() {
      function tentar() {
        if (window.PWAO_RegistrarCelula) {
          window.PWAO_RegistrarCelula({
            nome: "sistema.admin.visualizacao",
            caminho: "celulas/sistema/admin/painel.html",
            orgao: "sistema",
            versao: "1.0.0",
            descricao: "Painel de visualização de administradores"
          });
          return;
        }
        setTimeout(tentar, 60);
      }
      tentar();
    })();

    async function carregarLista() {
      const lista = await db.admin.toArray();
      const box = document.getElementById('lista');

      if (lista.length === 0) {
        box.innerHTML = '<p class="empty">Nenhum administrador cadastrado.</p>';
        return;
      }

      box.innerHTML = '';
      lista.forEach(adm => {
        const el = document.createElement('div');
        el.className = 'item';
        el.innerHTML = `
          <div><span class="label">Nome:</span> ${adm.nome}</div>
          <div><span class="label">Email:</span> ${adm.email}</div>
        `;
        box.appendChild(el);
      });
    }

    window.onload = carregarLista;
  </script>
</head>
<body>
  <div class="card">
    <h1>Administradores Cadastrados</h1>
    <div id="lista"></div>
  </div>
</body>
</html>
