<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recibo Orgânico de Diárias</title>
  <style>
    :root {
      --azul: #0f3d91;
      --areia: #f4f6fb;
      --cinza: #5b6472;
      --verde: #1b9e5a;
      --sombra: rgba(15, 61, 145, 0.12);
      --raio: 12px;
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 24px;
      font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
      background: radial-gradient(circle at 12% 20%, rgba(15, 61, 145, 0.08), transparent 35%),
                  radial-gradient(circle at 82% 10%, rgba(27, 158, 90, 0.08), transparent 32%),
                  #eef2f7;
      color: #1c2430;
    }

    .capa {
      max-width: 1060px;
      margin: 0 auto;
      background: white;
      border-radius: var(--raio);
      box-shadow: 0 18px 38px var(--sombra);
      overflow: hidden;
      border: 1px solid #e0e6f0;
    }

    header {
      background: linear-gradient(120deg, var(--azul), #1c5adb);
      color: white;
      padding: 26px 32px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 24px;
    }

    header .marca {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    header .marca strong { font-size: 1.15rem; letter-spacing: 0.6px; }
    header .marca span { opacity: 0.85; font-size: 0.95rem; }

    header .acoes {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      border-radius: 10px;
      padding: 12px 16px;
      font-weight: 700;
      font-size: 0.95rem;
      cursor: pointer;
      transition: transform 0.1s ease, box-shadow 0.2s ease;
    }

    button:hover { transform: translateY(-1px); }
    button:active { transform: translateY(0); }

    .btn-primario { background: #ff7a00; color: #0d0d0d; box-shadow: 0 10px 20px rgba(255, 122, 0, 0.25); }
    .btn-secundario { background: rgba(255,255,255,0.15); color: white; border: 1px solid rgba(255,255,255,0.25); }

    main { padding: 28px 32px 36px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
    @media (max-width: 900px) { main { grid-template-columns: 1fr; padding: 20px; } header { flex-direction: column; align-items: flex-start; } }

    .bloco {
      background: var(--areia);
      border-radius: var(--raio);
      padding: 18px 16px 16px;
      border: 1px solid #e8ecf2;
      box-shadow: 0 10px 24px rgba(12, 28, 64, 0.08);
    }

    .titulo-bloco {
      font-size: 0.95rem;
      font-weight: 800;
      letter-spacing: 0.4px;
      color: var(--azul);
      margin-bottom: 12px;
      text-transform: uppercase;
    }

    .grupo { display: flex; gap: 10px; margin-bottom: 12px; flex-wrap: wrap; }
    label { font-size: 0.85rem; color: var(--cinza); font-weight: 700; display: block; margin-bottom: 6px; }
    input, textarea, select {
      width: 100%;
      border: 1px solid #cfd6e6;
      border-radius: 10px;
      padding: 11px 12px;
      font-size: 0.95rem;
      font-family: inherit;
      background: white;
      color: #1f2836;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.7);
    }

    textarea { min-height: 80px; resize: vertical; }

    .campo { flex: 1; min-width: 220px; }

    .lista-diarias { display: flex; flex-direction: column; gap: 8px; margin-top: 6px; }

    .item-diaria {
      display: flex;
      align-items: center;
      gap: 12px;
      background: white;
      border: 1px solid #dfe6f3;
      padding: 10px 12px;
      border-radius: 10px;
    }

    .item-diaria input { margin: 0; }

    .item-diaria small { color: var(--cinza); font-weight: 700; width: 72px; }

    .item-diaria button { padding: 8px 10px; font-size: 0.9rem; background: #ffe4d1; color: #a04600; box-shadow: none; }

    .resumo {
      background: white;
      padding: 16px;
      border-radius: 10px;
      border: 1px dashed #d7dff0;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
      font-size: 0.95rem;
      color: #1f2836;
    }

    .recibo {
      background: #0d1730;
      color: #f5f7ff;
      border-radius: var(--raio);
      padding: 20px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.08);
    }

    .recibo h3 { margin: 0 0 12px; letter-spacing: 0.5px; }
    .recibo p { margin: 6px 0; color: #dce3ff; }
    .recibo strong { color: white; }
    .recibo .selo { display: inline-flex; align-items: center; gap: 8px; padding: 10px 12px; background: rgba(255, 122, 0, 0.12); border-radius: 999px; color: #ffd8b3; font-weight: 800; letter-spacing: 0.4px; text-transform: uppercase; }
    .recibo ul { padding-left: 18px; margin: 8px 0 0; color: #dce3ff; }
    .recibo li { margin-bottom: 4px; }
  </style>
</head>
<body>
  <div class="capa">
    <header>
      <div class="marca">
        <strong>Recibo Orgânico de Diárias</strong>
        <span>Produto vivo do domínio Governo – célula PWAO</span>
      </div>
      <div class="acoes">
        <button class="btn-secundario" id="btn-auto-preencher">Auto-preencher</button>
        <button class="btn-primario" id="btn-exportar">Exportar / Imprimir</button>
      </div>
    </header>

    <main>
      <section class="bloco">
        <div class="titulo-bloco">Dados básicos</div>
        <div class="grupo">
          <div class="campo">
            <label for="servidor">Servidor</label>
            <input id="servidor" type="text" placeholder="Nome completo" />
          </div>
          <div class="campo">
            <label for="cpf">CPF</label>
            <input id="cpf" type="text" placeholder="000.000.000-00" />
          </div>
        </div>
        <div class="grupo">
          <div class="campo">
            <label for="lotacao">Lotação / Secretaria</label>
            <input id="lotacao" type="text" placeholder="Ex.: SEAP" />
          </div>
          <div class="campo">
            <label for="cargo">Cargo</label>
            <input id="cargo" type="text" placeholder="Analista" />
          </div>
        </div>
        <div class="grupo">
          <div class="campo">
            <label for="objetivo">Objetivo da viagem</label>
            <textarea id="objetivo" placeholder="Descreva a missão, evento ou atividade"></textarea>
          </div>
        </div>
      </section>

      <section class="bloco">
        <div class="titulo-bloco">Roteiro e diárias</div>
        <div class="grupo">
          <div class="campo">
            <label for="origem">Origem</label>
            <input id="origem" type="text" placeholder="Curitiba - PR" />
          </div>
          <div class="campo">
            <label for="destino">Destino</label>
            <input id="destino" type="text" placeholder="Brasília - DF" />
          </div>
        </div>
        <div class="grupo">
          <div class="campo">
            <label for="periodo">Período</label>
            <input id="periodo" type="text" placeholder="12 a 14 de agosto" />
          </div>
          <div class="campo">
            <label for="referencia">Referência do processo</label>
            <input id="referencia" type="text" placeholder="SEI / Protocolo" />
          </div>
        </div>

        <div class="titulo-bloco" style="margin-top: 6px;">Diárias declaradas</div>
        <div class="lista-diarias" id="lista-diarias"></div>
        <div class="grupo" style="margin-top: 8px;">
          <button class="btn-primario" id="btn-adicionar">Adicionar diária</button>
        </div>
      </section>

      <section class="bloco">
        <div class="titulo-bloco">Assinaturas e notas</div>
        <div class="grupo">
          <div class="campo">
            <label for="responsavel">Responsável pela aprovação</label>
            <input id="responsavel" type="text" placeholder="Nome de quem autoriza" />
          </div>
          <div class="campo">
            <label for="contato">Contato institucional</label>
            <input id="contato" type="text" placeholder="E-mail ou telefone" />
          </div>
        </div>
        <div class="grupo">
          <div class="campo">
            <label for="observacoes">Observações finais</label>
            <textarea id="observacoes" placeholder="Pendências, anexos ou referências adicionais"></textarea>
          </div>
        </div>
      </section>

      <section class="bloco">
        <div class="titulo-bloco">Preview orgânico</div>
        <div class="recibo" id="recibo-preview">
          <span class="selo">PWAO · Governo</span>
          <h3>Pronto para registrar diárias</h3>
          <p>Preencha os campos ao lado e acompanhe o recibo vivo sendo gerado aqui.</p>
        </div>
        <div class="resumo" id="resumo-valores" style="display:none;"></div>
      </section>
    </main>
  </div>

  <script>
    (function registrarManifesto() {
      function tentar() {
        if (window.PWAO_RegistrarCelula) {
          window.PWAO_RegistrarCelula({
            nome: "governo.produtos.recibo-diarias.organico",
            caminho: "celulas/governo/produtos/recibo-diarias-organico.html",
            orgao: "governo",
            versao: "1.0.0",
            descricao: "Recibo simplificado e vivo de diárias no padrão PWAO"
          });
          return;
        }
        setTimeout(tentar, 50);
      }
      tentar();
    })();

    const lista = document.getElementById('lista-diarias');
    const preview = document.getElementById('recibo-preview');
    const resumoValores = document.getElementById('resumo-valores');

    const estado = {
      diarias: []
    };

    function adicionarDiaria(dia = '', valor = '') {
      const id = crypto.randomUUID();
      const item = document.createElement('div');
      item.className = 'item-diaria';
      item.dataset.id = id;
      item.innerHTML = `
        <small>Data</small>
        <input type="text" value="${dia}" placeholder="12/08" data-campo="dia" />
        <small>Valor</small>
        <input type="number" min="0" step="0.01" value="${valor}" data-campo="valor" />
        <button type="button" data-acao="remover">Remover</button>
      `;

      item.addEventListener('input', () => sincronizarDiarias());
      item.querySelector('[data-acao="remover"]').onclick = () => {
        item.remove();
        sincronizarDiarias();
      };

      lista.appendChild(item);
      sincronizarDiarias();
    }

    function sincronizarDiarias() {
      estado.diarias = Array.from(lista.querySelectorAll('.item-diaria')).map((item) => {
        return {
          id: item.dataset.id,
          dia: item.querySelector('[data-campo="dia"]').value.trim(),
          valor: Number(item.querySelector('[data-campo="valor"]').value) || 0
        };
      });
      atualizarPreview();
    }

    function lerValor(id) {
      const el = document.getElementById(id);
      return el ? el.value.trim() : '';
    }

    function atualizarPreview() {
      const total = estado.diarias.reduce((soma, item) => soma + item.valor, 0);
      const dias = estado.diarias.filter((d) => d.dia || d.valor);

      const detalhes = {
        servidor: lerValor('servidor'),
        cpf: lerValor('cpf'),
        lotacao: lerValor('lotacao'),
        cargo: lerValor('cargo'),
        origem: lerValor('origem'),
        destino: lerValor('destino'),
        periodo: lerValor('periodo'),
        objetivo: lerValor('objetivo'),
        referencia: lerValor('referencia'),
        responsavel: lerValor('responsavel'),
        contato: lerValor('contato'),
        observacoes: lerValor('observacoes')
      };

      preview.innerHTML = `
        <span class="selo">PWAO · Governo</span>
        <h3>Recibo orgânico de diárias</h3>
        <p><strong>Servidor:</strong> ${detalhes.servidor || '—'} | <strong>CPF:</strong> ${detalhes.cpf || '—'}</p>
        <p><strong>Lotação:</strong> ${detalhes.lotacao || '—'} · <strong>Cargo:</strong> ${detalhes.cargo || '—'}</p>
        <p><strong>Origem/Destino:</strong> ${detalhes.origem || '—'} → ${detalhes.destino || '—'}</p>
        <p><strong>Período:</strong> ${detalhes.periodo || '—'} · <strong>Processo:</strong> ${detalhes.referencia || '—'}</p>
        <p><strong>Objetivo:</strong> ${detalhes.objetivo || '—'}</p>
        ${dias.length ? `<p><strong>Diárias declaradas:</strong></p><ul>${dias.map(d => `<li>${d.dia || 'Data indefinida'} — R$ ${d.valor.toFixed(2)}</li>`).join('')}</ul>` : '<p>Nenhuma diária adicionada até agora.</p>'}
        <p style="margin-top:12px;"><strong>Responsável:</strong> ${detalhes.responsavel || '—'} · <strong>Contato:</strong> ${detalhes.contato || '—'}</p>
        ${detalhes.observacoes ? `<p><strong>Observações:</strong> ${detalhes.observacoes}</p>` : ''}
      `;

      if (dias.length) {
        resumoValores.style.display = 'grid';
        resumoValores.innerHTML = `
          <div><strong>Total de diárias</strong><br/>R$ ${total.toFixed(2)}</div>
          <div><strong>Quantidade</strong><br/>${dias.length} diária(s)</div>
          <div><strong>Origem</strong><br/>${detalhes.origem || '—'}</div>
          <div><strong>Destino</strong><br/>${detalhes.destino || '—'}</div>
        `;
      } else {
        resumoValores.style.display = 'none';
      }
    }

    document.getElementById('btn-adicionar').onclick = () => adicionarDiaria();
    document.getElementById('btn-exportar').onclick = () => window.print();
    document.getElementById('btn-auto-preencher').onclick = () => {
      document.getElementById('servidor').value = 'Ana Ribeiro';
      document.getElementById('cpf').value = '123.456.789-00';
      document.getElementById('lotacao').value = 'Secretaria de Tecnologia';
      document.getElementById('cargo').value = 'Gestora de Projetos';
      document.getElementById('origem').value = 'Curitiba - PR';
      document.getElementById('destino').value = 'Brasília - DF';
      document.getElementById('periodo').value = '12 a 14 de agosto';
      document.getElementById('referencia').value = 'SEI 0012345-99';
      document.getElementById('objetivo').value = 'Reuniões para apresentação do organismo PWAO e alinhamento de convênios digitais.';
      document.getElementById('responsavel').value = 'Marcos Souza';
      document.getElementById('contato').value = 'marcos.souza@gov.br';
      document.getElementById('observacoes').value = 'Comprovantes anexados eletronicamente via SEI.';

      lista.innerHTML = '';
      adicionarDiaria('12/08', 420.5);
      adicionarDiaria('13/08', 420.5);
      adicionarDiaria('14/08', 210.25);
      atualizarPreview();
    };

    adicionarDiaria();
  </script>
</body>
</html>
