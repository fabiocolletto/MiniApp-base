<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MiniApps – Hub Principal</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap"
        rel="stylesheet"
    />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,400..700,0..1,-50..200"
        rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
</head>
<body>
    <div class="app-shell">
        <div class="header-bar">
            <a class="link-button" href="/public/legacy/index-legacy.html">Home legada</a>
            <button class="theme-toggle" type="button" data-theme-toggle aria-label="Alternar tema">
                <span class="material-symbols-rounded" aria-hidden="true" data-theme-icon>dark_mode</span>
                <span class="sr-only" data-theme-label>Usar tema escuro</span>
            </button>
        </div>

        <header class="hero">
            <div class="status-chip" aria-label="novo hub de MiniApps">
                <span class="material-symbols-rounded" aria-hidden="true">rocket_launch</span>
                Novo index ativo
            </div>
            <h1>Portfólio de MiniApps</h1>
            <p>Acesse os módulos disponíveis e acompanhe os próximos lançamentos.</p>
        </header>

        <section class="grid" aria-label="MiniApps disponíveis" data-cards-grid>
            <p class="muted" data-cards-loading>Carregando catálogo...</p>
        </section>
    </div>

    <script type="module">
        const statusLabels = {
            ativo: { label: 'Ativo', badgeTone: 'success' },
            soon: { label: 'Em breve', badgeTone: 'muted' },
        };

        const toneClass = {
            pink: 'card--pink',
            green: 'card--green',
            peach: 'card--peach',
            amber: 'card--amber',
        };

        const grid = document.querySelector('[data-cards-grid]');
        const loading = document.querySelector('[data-cards-loading]');

        const buildCard = (item) => {
            const cardEl = document.createElement(item.href ? 'a' : 'article');
            cardEl.className = `card ${toneClass[item.tone] || ''} ${item.href ? '' : 'disabled'}`.trim();
            cardEl.href = item.href || '#';
            cardEl.setAttribute('aria-label', `${item.title}${item.href ? '' : ' em breve'}`);

            cardEl.innerHTML = `
                <div class="card-header">
                    <span class="icon-wrap" aria-hidden="true">
                        <span class="material-symbols-rounded">${item.icon}</span>
                    </span>
                    <div class="card-meta">
                        <h2>${item.title}</h2>
                        <div class="badge badge--${statusLabels[item.status]?.badgeTone || 'muted'}">
                            ${statusLabels[item.status]?.label || 'Indefinido'}
                        </div>
                    </div>
                </div>
                <p>${item.description}</p>
            `;

            if (!item.href) {
                cardEl.role = 'article';
                cardEl.tabIndex = 0;
            }

            return cardEl;
        };

        fetch('../modules/content/catalog/cards-2000.json')
            .then((response) => {
                if (!response.ok) throw new Error('Falha ao carregar catálogo.');
                return response.json();
            })
            .then((items) => {
                if (loading) loading.remove();
                items.forEach((item) => grid.appendChild(buildCard(item)));
            })
            .catch(() => {
                if (loading) loading.textContent = 'Não foi possível carregar o catálogo.';
            });
    </script>
    <script src="/theme.js"></script>
</body>
</html>
