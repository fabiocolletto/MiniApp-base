<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MiniApp - Admin Produtos (Sistema)</title>

  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet" />

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp@main/docs/miniapp-global.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp@main/docs/miniapp-card.css" />

  <!-- Core libs (UMD) -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/@emotion/react@11.11.1/dist/emotion-react.umd.min.js"></script>
  <script crossorigin src="https://unpkg.com/@emotion/styled@11.11.0/dist/emotion-styled.umd.min.js"></script>
  <script crossorigin src="https://unpkg.com/@mui/material@5.15.14/umd/material-ui.production.min.js"></script>

  <!-- idb antes de qualquer shared que use store -->
  <script src="https://cdn.jsdelivr.net/npm/idb@7.1.1/build/umd.js"></script>

  <!-- Shared UI -->
  <script src="https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp@main/docs/components/app-shared-ui.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp@main/docs/components/app-modal-context.js"></script>

  <!-- Shared Admin API (docs/components) -->
  <script src="https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp@main/docs/components/admin-shared.js"></script>

  <meta name="theme-color" content="#020617" />
</head>

<body class="miniapp-shell" style="margin:0; padding:0; width:100%; height:100%; overflow-x:hidden;">
  <main id="admin-products-root" class="miniapp-stage"></main>

  <script>
    // ===== Util =====
    function waitForGlobals(checkFn, { tries = 180 } = {}) {
      return new Promise((resolve) => {
        let t = 0;
        const tick = () => {
          const res = checkFn();
          if (res.ok || t >= tries) return resolve(res);
          t++;
          requestAnimationFrame(tick);
        };
        tick();
      });
    }

    function pickGlobals() {
      const ReactLib = window.React;
      const ReactDOMLib = window.ReactDOM;
      const Material = window.MaterialUI || window.MaterialUI?.default;
      const idb = window.idb;

      const missing = [];
      if (!ReactLib) missing.push("React");
      if (!ReactDOMLib) missing.push("ReactDOM");
      if (!Material) missing.push("MaterialUI");
      if (!idb) missing.push("idb");

      return { ok: missing.length === 0, ReactLib, ReactDOMLib, Material, idb, missing };
    }

    // ===== Fallbacks leves (não travam a UI) =====
    function ensureAppUI(ReactLib) {
      if (window.AppUI?.AppCard && window.AppUI?.AppButton) return window.AppUI;

      const e = ReactLib.createElement;
      const AppCard = ({ title, subtitle, helper, children }) =>
        e("section", { style:{ width:"100%", background:"rgba(255,255,255,0.03)", border:"1px solid rgba(255,255,255,0.08)", borderRadius:12, padding:16 } },
          e("div", { style:{ marginBottom:12 } },
            e("div", { style:{ fontWeight:800, fontSize:18 } }, title || ""),
            subtitle && e("div", { style:{ opacity:.7, fontSize:12 } }, subtitle),
            helper && e("div", { style:{ opacity:.6, fontSize:12, marginTop:4 } }, helper)
          ),
          children
        );

      const AppButton = ({ children, onClick, variant="outlined", tone="secondary", ...rest }) => {
        const base = {
          padding:"6px 10px",
          borderRadius:8,
          border: variant === "text" ? "none" : "1px solid rgba(255,255,255,0.2)",
          background: variant === "text" ? "transparent" : "rgba(255,255,255,0.04)",
          cursor:"pointer",
          fontSize:12,
          fontWeight:700,
          color: tone === "danger" ? "#ff8a8a" : "inherit"
        };
        return e("button", { style:base, onClick, ...rest }, children);
      };

      window.AppUI = { AppCard, AppButton };
      return window.AppUI;
    }

    function ensureModalProvider() {
      if (window.AppModalContext?.AppModalProvider) return window.AppModalContext;
      window.AppModalContext = { AppModalProvider: ({ children }) => children };
      return window.AppModalContext;
    }

    function ensureAdminShared(idb) {
      const sharedAPI = window.AdminAPI || window.AdminShared?.AdminAPI || window.AdminShared?.api || window.AdminShared || window.Admin;
      const sharedStore = window.AdminStore || window.AdminShared?.AdminStore || window.AdminShared?.store;
      if (sharedAPI && sharedStore) {
        window.AdminAPI = sharedAPI;
        window.AdminStore = sharedStore;
        return { AdminAPI: sharedAPI, AdminStore: sharedStore };
      }

      // Fallback total = teu bloco antigo (Caminho A)
      const API_BASE = "https://script.google.com/macros/s/AKfycbwcm49CbeSuT-f8r-RvzhntPz6RRVWz3l0sNv-e_mM4ADB_CQXRvsmyWSsdWGT8qCQ6jw/exec";

      const DB_NAME = "miniapp-db";
      const DB_VERSION = 3;
      const ST_PREFS = "system_prefs";
      let dbPromise = null;

      function openDB(){
        if (dbPromise) return dbPromise;
        dbPromise = idb.openDB(DB_NAME, DB_VERSION, {
          upgrade(db){
            if (!db.objectStoreNames.contains(ST_PREFS)) {
              db.createObjectStore(ST_PREFS, { keyPath: "key" });
            }
          }
        });
        return dbPromise;
      }

      const PrefDriver = {
        async get(key){ const db = await openDB(); return db.get(ST_PREFS, key); },
        async put(val){ const db = await openDB(); return db.put(ST_PREFS, val); }
      };

      window.AdminStore = {
        async setPref(key, value){
          await PrefDriver.put({ key, value, updatedAt: new Date().toISOString() });
          return true;
        },
        async getPref(key, def=null){
          const r = await PrefDriver.get(key);
          return r ? r.value : def;
        }
      };

      async function getToken(){
        try { return await window.AdminStore.getPref("admin_api_token", "") || ""; }
        catch(e){ return ""; }
      }
      function withToken(url, token){
        return token ? `${url}&token=${encodeURIComponent(token)}` : url;
      }
      async function read(tab){
        const token = await getToken();
        const url = withToken(`${API_BASE}?action=read&tab=${encodeURIComponent(tab)}`, token);
        return fetch(url).then(r=>r.json());
      }
      async function upsert(tab, data){
        const token = await getToken();
        const url = withToken(`${API_BASE}?action=upsert&tab=${encodeURIComponent(tab)}`, token);
        return fetch(url, {
          method:"POST", headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ data })
        }).then(r=>r.json());
      }
      async function remove(tab, id){
        const token = await getToken();
        const url = withToken(`${API_BASE}?action=delete&tab=${encodeURIComponent(tab)}`, token);
        return fetch(url, {
          method:"POST", headers:{ "Content-Type":"application/json" },
          body: JSON.stringify({ data:{ id } })
        }).then(r=>r.json());
      }
      window.AdminAPI = { read, upsert, remove };

      return { AdminAPI: window.AdminAPI, AdminStore: window.AdminStore };
    }

    // ===== Bootstrap =====
    waitForGlobals(pickGlobals).then(({ ReactLib, ReactDOMLib, Material, idb, missing }) => {
      const root = document.getElementById("admin-products-root");

      if (missing.length) {
        root.innerHTML = `
          <div style="padding:20px;color:#ffb4b4;background:#220000;margin:20px;border-radius:12px;">
            <h2>❌ ERRO CRÍTICO</h2>
            <p>Dependências CORE faltando: <b>${missing.join(", ")}</b></p>
            <p>Isso normalmente é bloqueio de CDN/rede ou CSP do iframe.</p>
          </div>`;
        return; // sem throw para não sujar o console do Stage
      }

      // garante shims
      const AppUI = ensureAppUI(ReactLib);
      const AppModalContext = ensureModalProvider();
      const { AdminAPI, AdminStore } = ensureAdminShared(idb);

      const { useCallback, useEffect, useMemo, useState } = ReactLib;
      const {
        ThemeProvider, createTheme, CssBaseline,
        Box, Stack, Typography, TextField,
        FormControl, InputLabel, Select, MenuItem,
        Divider, Chip, Switch, FormControlLabel
      } = Material;

      const e = ReactLib.createElement;
      const { AppCard, AppButton } = AppUI;

      const TAB_PRODUCTS = "products";
      const TAB_CATEGORIES = "categories";
      const ORANGE = "#f97316";

      function uid(prefix){
        return (prefix||"id") + "_" + Math.random().toString(36).slice(2) + Date.now().toString(36);
      }
      function num(v, def=0){
        const n = Number(v);
        return Number.isFinite(n) ? n : def;
      }

      function getOutlinedSx(mode){
        const baseBorder = mode === "light"
          ? "rgba(2,6,23,0.18)"
          : "rgba(255,255,255,0.18)";
        const hoverBorder = mode === "light"
          ? "rgba(2,6,23,0.35)"
          : "rgba(255,255,255,0.35)";

        return {
          backgroundColor: "transparent",
          "& .MuiOutlinedInput-root": { backgroundColor: "transparent" },
          "& .MuiOutlinedInput-notchedOutline": {
            borderColor: baseBorder,
            borderWidth: 1
          },
          "&:hover .MuiOutlinedInput-notchedOutline": { borderColor: hoverBorder },
          "& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline": {
            borderColor: ORANGE,
            boxShadow: "none"
          }
        };
      }

      function AdminProductsCard({ mode }) {
        const emptyProduct = useMemo(() => ({
          id: "",
          name: "",
          sku: "",
          description: "",
          price: 0,
          currency: "BRL",
          active: true,
          visibility: "public",
          categoryId: "",
          imageUrl: "",
          order: 0,
          stock: "",
          tags: "",
          mpProductId: "",
          mpPriceId: ""
        }), []);

        const [items, setItems] = useState([]);
        const [categories, setCategories] = useState([]);
        const [form, setForm] = useState(emptyProduct);
        const [editingId, setEditingId] = useState(null);
        const [loading, setLoading] = useState(true);
        const [error, setError] = useState(null);
        const [ok, setOk] = useState(null);

        const outlinedSx = useMemo(() => getOutlinedSx(mode), [mode]);

        const reloadAll = useCallback(async () => {
          setLoading(true);
          setError(null);
          try {
            const [prodRes, catRes] = await Promise.all([
              AdminAPI.read(TAB_PRODUCTS),
              AdminAPI.read(TAB_CATEGORIES)
            ]);

            if (!prodRes?.ok) throw new Error("Falha ao ler products");
            if (!catRes?.ok) throw new Error("Falha ao ler categories");

            const list = (prodRes.data || []).map(p => ({
              ...p,
              price: num(p.price, 0),
              order: num(p.order, 0),
              active: p.active !== false && String(p.active) !== "false"
            }));

            const cats = (catRes.data || []).map(c => ({
              ...c,
              order: num(c.order, 0),
              active: c.active !== false && String(c.active) !== "false"
            }));

            list.sort((a,b)=> a.order - b.order);
            cats.sort((a,b)=> a.order - b.order);

            setItems(list);
            setCategories(cats);
          } catch (err) {
            setItems([]);
            setCategories([]);
            setError("Não foi possível carregar dados da planilha.");
          } finally {
            setLoading(false);
          }
        }, []);

        useEffect(() => { reloadAll(); }, [reloadAll]);

        const onNew = useCallback(() => {
          setEditingId(null);
          setForm(emptyProduct);
          setError(null);
          setOk(null);
        }, [emptyProduct]);

        const onEdit = useCallback((it) => {
          setEditingId(it.id);
          setForm({
            ...emptyProduct,
            ...it,
            price: num(it.price, 0),
            order: num(it.order, 0)
          });
          setError(null);
          setOk(null);
        }, [emptyProduct]);

        const onDelete = useCallback(async (it) => {
          setError(null);
          setOk(null);
          const sure = confirm(`Excluir "${it.name}"? Essa ação não pode ser desfeita.`);
          if (!sure) return;

          try {
            const res = await AdminAPI.remove(TAB_PRODUCTS, it.id);
            if (!res?.ok) throw new Error("delete fail");
            await reloadAll();
            setOk("Produto excluído.");
            if (editingId === it.id) onNew();
          } catch (err) {
            setError("Falha ao excluir produto.");
          }
        }, [editingId, onNew, reloadAll]);

        function validate(){
          if (!form.name) return "Nome do produto é obrigatório.";
          if (num(form.price,0) <= 0) return "Preço deve ser maior que zero.";
          return null;
        }

        const onSave = useCallback(async () => {
          setError(null);
          setOk(null);

          const v = validate();
          if (v) { setError(v); return; }

          const patched = {
            ...form,
            id: form.id || uid("prod"),
            price: num(form.price, 0),
            order: num(form.order, 0),
            active: !!form.active
          };

          try {
            const res = await AdminAPI.upsert(TAB_PRODUCTS, patched);
            if (!res?.ok) throw new Error("upsert fail");
            await reloadAll();
            setOk(editingId ? "Produto atualizado." : "Produto criado.");

            if (!editingId) {
              setEditingId(null);
              setForm(emptyProduct);
            } else {
              setEditingId(patched.id);
              setForm(patched);
            }
          } catch (err) {
            setError("Falha ao salvar produto na planilha.");
          }
        }, [editingId, form, reloadAll, emptyProduct]);

        return e(
          AppCard,
          {
            title: "Cadastro de Produtos",
            subtitle: "Aba products da planilha central",
            helper: "Produtos alimentam Catálogo e Mercado Pago. Sem autosave."
          },
          e(Stack, { spacing: 2 },

            loading && e(Typography, { variant:"caption", color:"text.secondary" }, "Carregando planilha..."),

            !loading && items.length === 0 &&
              e(Typography, { variant:"caption", color:"text.secondary" }, "Nenhum produto cadastrado."),

            !loading && items.length > 0 &&
              e(Stack, { spacing: 1 },
                items.map(it =>
                  e(Box, {
                    key: it.id,
                    sx: {
                      display: "flex",
                      alignItems: "center",
                      justifyContent: "space-between",
                      p: 1,
                      border: "1px solid rgba(255,255,255,0.12)",
                      borderRadius: "10px",
                      background: "rgba(255,255,255,0.02)"
                    }
                  },
                    e(Stack, { spacing: 0.25 },
                      e(Typography, { variant:"body2", fontWeight:600 }, it.name),
                      e(Typography, { variant:"caption", color:"text.secondary" },
                        `SKU: ${it.sku || "-"} · R$ ${num(it.price,0).toFixed(2)} · ${it.visibility || "public"}`
                      ),
                      it.active === false && e(Chip, { size:"small", label:"Inativo", variant:"outlined" })
                    ),
                    e(Stack, { direction:"row", spacing: 1 },
                      e(AppButton, { tone:"secondary", variant:"outlined", onClick: ()=>onEdit(it) }, "Editar"),
                      e(AppButton, { tone:"danger", variant:"outlined", onClick: ()=>onDelete(it) }, "Excluir")
                    )
                  )
                )
              ),

            e(Divider),

            e(Stack, { direction:"row", spacing:1, alignItems:"center", justifyContent:"space-between" },
              e(Typography, { variant:"subtitle2", fontWeight:700 }, editingId ? "Editar produto" : "Novo produto"),
              e(AppButton, { tone:"ghost", variant:"text", onClick: onNew }, "Limpar / Novo")
            ),

            e(Stack, { spacing: 1.5 },

              e(TextField, {
                label:"Nome do produto",
                variant:"outlined", size:"small", sx: outlinedSx,
                fullWidth:true,
                value: form.name || "",
                onChange: ev => setForm(f => ({ ...f, name: ev.target.value }))
              }),

              e(TextField, {
                label:"SKU / Código interno",
                variant:"outlined", size:"small", sx: outlinedSx,
                fullWidth:true,
                value: form.sku || "",
                onChange: ev => setForm(f => ({ ...f, sku: ev.target.value }))
              }),

              e(TextField, {
                label:"Descrição",
                variant:"outlined", size:"small", sx: outlinedSx,
                fullWidth:true, multiline:true, minRows:2,
                value: form.description || "",
                onChange: ev => setForm(f => ({ ...f, description: ev.target.value }))
              }),

              e(Stack, { direction:"row", spacing: 2 },
                e(TextField, {
                  label:"Preço (R$)",
                  variant:"outlined", size:"small", sx: outlinedSx,
                  fullWidth:true, type:"number",
                  value: form.price ?? 0,
                  onChange: ev => setForm(f => ({ ...f, price: ev.target.value }))
                }),
                e(FormControl, { fullWidth:true, size:"small", sx: outlinedSx },
                  e(InputLabel, null, "Moeda"),
                  e(Select, {
                    value: form.currency || "BRL",
                    label:"Moeda",
                    onChange: ev => setForm(f => ({ ...f, currency: ev.target.value }))
                  },
                    e(MenuItem, { value:"BRL" }, "BRL"),
                    e(MenuItem, { value:"USD" }, "USD"),
                    e(MenuItem, { value:"EUR" }, "EUR")
                  )
                )
              ),

              e(TextField, {
                label:"Imagem (URL)",
                variant:"outlined", size:"small", sx: outlinedSx,
                fullWidth:true,
                value: form.imageUrl || "",
                onChange: ev => setForm(f => ({ ...f, imageUrl: ev.target.value }))
              }),

              e(TextField, {
                label:"Tags (separadas por vírgula)",
                variant:"outlined", size:"small", sx: outlinedSx,
                fullWidth:true,
                value: form.tags || "",
                onChange: ev => setForm(f => ({ ...f, tags: ev.target.value }))
              }),

              e(Stack, { direction:"row", spacing:2 },
                e(FormControl, { fullWidth:true, size:"small", sx: outlinedSx },
                  e(InputLabel, null, "Categoria (Catálogo)"),
                  e(Select, {
                    value: form.categoryId || "",
                    label:"Categoria (Catálogo)",
                    onChange: ev => setForm(f => ({ ...f, categoryId: ev.target.value }))
                  },
                    e(MenuItem, { value:"" }, "Sem categoria"),
                    categories.map(c => e(MenuItem, { key:c.id, value:c.id }, c.name))
                  )
                ),
                e(FormControl, { fullWidth:true, size:"small", sx: outlinedSx },
                  e(InputLabel, null, "Visibilidade"),
                  e(Select, {
                    value: form.visibility || "public",
                    label:"Visibilidade",
                    onChange: ev => setForm(f => ({ ...f, visibility: ev.target.value }))
                  },
                    e(MenuItem, { value:"public" }, "Público"),
                    e(MenuItem, { value:"private" }, "Privado"),
                    e(MenuItem, { value:"beta" }, "Beta")
                  )
                )
              ),

              e(Stack, { direction:"row", spacing:2, alignItems:"center" },
                e(TextField, {
                  label:"Ordem",
                  variant:"outlined", size:"small", sx: outlinedSx,
                  fullWidth:true, type:"number",
                  value: form.order ?? 0,
                  onChange: ev => setForm(f => ({ ...f, order: ev.target.value }))
                }),
                e(TextField, {
                  label:"Estoque (opcional)",
                  variant:"outlined", size:"small", sx: outlinedSx,
                  fullWidth:true,
                  value: form.stock || "",
                  onChange: ev => setForm(f => ({ ...f, stock: ev.target.value }))
                }),
                e(FormControlLabel, {
                  control: e(Switch, {
                    checked: form.active !== false,
                    onChange: ev => setForm(f => ({ ...f, active: ev.target.checked }))
                  }),
                  label: form.active === false ? "Inativo" : "Ativo"
                })
              ),

              e(Divider),

              e(Typography, { variant:"subtitle2", fontWeight:700 }, "Mercado Pago"),

              e(Stack, { direction:"row", spacing:2 },
                e(TextField, {
                  label:"MP Product ID",
                  variant:"outlined", size:"small", sx: outlinedSx,
                  fullWidth:true,
                  value: form.mpProductId || "",
                  onChange: ev => setForm(f => ({ ...f, mpProductId: ev.target.value }))
                }),
                e(TextField, {
                  label:"MP Price ID",
                  variant:"outlined", size:"small", sx: outlinedSx,
                  fullWidth:true,
                  value: form.mpPriceId || "",
                  onChange: ev => setForm(f => ({ ...f, mpPriceId: ev.target.value }))
                })
              )
            ),

            error && e(Typography, { variant:"caption", color:"error.main" }, error),
            ok && e(Typography, { variant:"caption", color:"success.main" }, ok),

            e(Stack, { direction:"row", spacing: 1.5, justifyContent:"flex-end", mt: 1 },
              e(AppButton, { tone:"secondary", variant:"outlined", onClick: onSave },
                editingId ? "Salvar alterações" : "Criar produto"
              )
            )
          )
        );
      }

      function Layout() {
        const [preferences, setPreferences] = useState(() => ({ theme: "dark", language: "pt-BR" }));
        const apply = useCallback(next => setPreferences(prev => ({ ...prev, ...next })), []);

        useEffect(() => {
          Promise.all([
            AdminStore.getPref("theme", "dark"),
            AdminStore.getPref("language", "pt-BR")
          ]).then(([t, l]) => apply({ theme: t, language: l }));
        }, [apply]);

        useEffect(() => {
          function onMsg(event) {
            const payload = event?.data;
            if (!payload || payload.type !== "miniapp:global-preferences") return;
            const p = payload.preferences || {};
            if (p.theme || p.language) {
              apply({
                theme: p.theme || preferences.theme,
                language: p.language || preferences.language
              });
            }
          }
          window.addEventListener("message", onMsg);
          return () => window.removeEventListener("message", onMsg);
        }, [apply, preferences.theme, preferences.language]);

        const appTheme = useMemo(() => createTheme({
          palette: {
            mode: preferences.theme === "light" ? "light" : "dark",
            primary: { main: "#4CAF50" },
            secondary: { main: "#0ea5e9" },
            error: { main: "#f44336" },
            background: {
              default: preferences.theme === "light" ? "#f3f4f6" : "#020617",
              paper: preferences.theme === "light" ? "#ffffff" : "#0f172a"
            }
          },
          typography: { fontFamily: '"Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif' },
          shape: { borderRadius: 0 }
        }), [preferences.theme]);

        const mode = appTheme.palette.mode;

        useEffect(() => {
          const stage = document.querySelector(".miniapp-stage");
          if (!stage || !window.ResizeObserver) return;

          let lastH = 0;
          const postHeight = () => {
            const h = Math.max(stage.scrollHeight, stage.offsetHeight, 200);
            if (Math.abs(h - lastH) < 8) return;
            lastH = h;
            window.parent?.postMessage({
              type: "catalog:height",
              sourceId: "admin-products",
              height: h
            }, "*");
          };

          const ro = new ResizeObserver(() => postHeight());
          ro.observe(stage);
          postHeight();

          return () => ro.disconnect();
        }, []);

        const ModalProvider = AppModalContext.AppModalProvider || function FallbackProvider({ children }) { return children; };

        return e(
          ThemeProvider, { theme: appTheme },
          e(CssBaseline),
          e(
            ModalProvider, null,
            e("div", { className: "miniapp-shell", style: { minHeight:"100vh", display:"flex", flexDirection:"column" } },
              e(Box, { component:"main", className:"miniapp-stage", sx:{ flex:1, display:"flex", flexDirection:"column" } },
                e(Box, { sx:{ flex:1, display:"flex", flexDirection:"column", alignItems:"center", justifyContent:"center", p:{ xs:2, md:4 } } },
                  e(Box, { sx:{ width:"100%", maxWidth:"820px" } },
                    e(AdminProductsCard, { mode })
                  )
                )
              )
            )
          )
        );
      }

      (async function bootstrapAndRender(){
        try {
          if (window.AdminShared?.init) {
            await window.AdminShared.init();
          }
        } catch (e) {
          console.warn("AdminShared.init falhou, seguindo com defaults.");
        }

        ReactDOMLib.createRoot(root).render(e(Layout));
      })();

    });
  </script>
</body>
</html>
