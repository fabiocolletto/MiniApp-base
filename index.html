<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>App 5 Horas – MiniApps</title>

  <!-- Google Fonts / Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@500;600;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,400..700,0..1,-50..200"
    rel="stylesheet"
  />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tokens simples de tema -->
  <style>
    :root {
      color-scheme: light dark;
      --page-bg: 0 0 0;
      --page-bg-alpha: .92;
      --page-fg: 248 250 252;
      --page-fg-muted: 148 163 184;
      --page-border: 255 255 255;
    }

    html[data-theme="light"] {
      color-scheme: light;
      --page-bg: 248 250 252;
      --page-bg-alpha: .96;
      --page-fg: 15 23 42;
      --page-fg-muted: 71 85 105;
      --page-border: 15 23 42;
    }

    body {
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    }
  </style>
</head>
<body
  class="min-h-screen antialiased relative text-[rgb(var(--page-fg))] bg-[rgb(var(--page-bg)/var(--page-bg-alpha))] transition-colors"
>

  <!-- HEADER FIXO, TRANSPARENTE -->
  <header class="fixed top-0 inset-x-0 z-30 px-4 pt-3">
    <div class="max-w-5xl mx-auto flex items-center justify-between">
      <div class="flex items-center gap-2">
        <div class="inline-flex h-8 w-8 items-center justify-center rounded-2xl border border-white/10 bg-white/5 text-xs font-semibold tracking-tight">
          5h
        </div>
        <div class="flex flex-col leading-tight">
          <span class="text-sm font-semibold">App 5 Horas</span>
          <span class="text-[0.7rem] opacity-70">Portfólio de MiniApps</span>
        </div>
      </div>

      <div class="flex items-center gap-2">
        <!-- Botão de tema -->
        <button
          id="theme-toggle"
          type="button"
          class="inline-flex h-9 w-9 items-center justify-center rounded-full border border-white/15 bg-black/10 backdrop-blur-sm text-sm hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-white/40"
          aria-label="Alternar tema"
        >
          <span class="material-symbols-rounded text-base">
            dark_mode
          </span>
        </button>

        <!-- Botão painel do usuário -->
        <button
          id="user-btn"
          type="button"
          class="inline-flex h-9 items-center gap-2 rounded-full border border-white/15 bg-black/10 px-3 backdrop-blur-sm text-xs font-medium hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-white/40"
          aria-label="Abrir painel do usuário"
        >
          <span class="material-symbols-rounded text-base">
            account_circle
          </span>
          <span class="hidden sm:inline">
            Usuário
          </span>
        </button>
      </div>
    </div>
  </header>

  <!-- PAINEL DO USUÁRIO (MODAL CENTRAL) -->
  <div
    id="user-panel"
    class="hidden fixed inset-0 z-40 items-center justify-center bg-black/60 backdrop-blur-sm"
    aria-modal="true"
    role="dialog"
  >
    <div class="mx-4 w-full max-w-md rounded-3xl border border-[rgb(var(--page-border)/0.18)] bg-[rgb(var(--page-bg)/0.96)] p-5 shadow-xl">
      <div class="flex items-start justify-between gap-3">
        <div>
          <h2 class="text-base sm:text-lg font-semibold">
            Dados do usuário
          </h2>
          <p class="mt-1 text-xs sm:text-[0.75rem] text-[rgb(var(--page-fg-muted))]">
            Os dados ficam salvos apenas neste dispositivo.
          </p>
        </div>

        <button
          id="user-close"
          type="button"
          class="inline-flex h-7 w-7 items-center justify-center rounded-full border border-white/15 bg-black/20 text-xs hover:bg-white/10 transition focus:outline-none focus:ring-2 focus:ring-white/40"
          aria-label="Fechar painel do usuário"
        >
          <span class="material-symbols-rounded text-sm">
            close
          </span>
        </button>
      </div>

      <form id="user-form" class="mt-4 space-y-3 text-sm">
        <div>
          <label for="user-name" class="block text-xs font-medium mb-1">
            Nome completo
          </label>
          <input
            id="user-name"
            type="text"
            autocomplete="name"
            class="w-full rounded-2xl border border-white/15 bg-black/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-400/80 focus:border-transparent"
            placeholder="Seu nome e sobrenome"
            required
          />
        </div>

        <div>
          <label for="user-phone" class="block text-xs font-medium mb-1">
            Telefone (WhatsApp)
          </label>
          <input
            id="user-phone"
            type="tel"
            inputmode="tel"
            class="w-full rounded-2xl border border-white/15 bg-black/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-400/80 focus:border-transparent"
            placeholder="+55 DDD número"
            required
          />
        </div>

        <div>
          <label for="user-email" class="block text-xs font-medium mb-1">
            E-mail
          </label>
          <input
            id="user-email"
            type="email"
            autocomplete="email"
            class="w-full rounded-2xl border border-white/15 bg-black/10 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-emerald-400/80 focus:border-transparent"
            placeholder="seuemail@exemplo.com"
            required
          />
        </div>

        <div class="pt-1 flex flex-col sm:flex-row gap-2 sm:items-center sm:justify-between">
          <button
            type="submit"
            class="inline-flex items-center justify-center rounded-full bg-emerald-500 px-4 py-1.5 text-xs font-semibold text-emerald-950 hover:bg-emerald-400 transition focus:outline-none focus:ring-2 focus:ring-emerald-300"
          >
            <span class="material-symbols-rounded text-sm mr-1">
              save
            </span>
            Salvar neste dispositivo
          </button>

          <button
            id="user-delete"
            type="button"
            class="inline-flex items-center justify-center rounded-full border border-red-400/60 px-3 py-1 text-[0.7rem] font-medium text-red-200 hover:bg-red-500/10 transition focus:outline-none focus:ring-2 focus:ring-red-300"
          >
            <span class="material-symbols-rounded text-sm mr-1">
              delete
            </span>
            Remover dados
          </button>
        </div>
      </form>

      <div class="mt-4 border-t border-white/10 pt-3">
        <p
          id="user-status"
          class="text-[0.7rem] text-[rgb(var(--page-fg-muted))]"
        >
          Preencha seus dados para salvá-los neste dispositivo.
        </p>

        <div id="user-summary" class="mt-2"></div>
      </div>
    </div>
  </div>

  <!-- CONTEÚDO PRINCIPAL -->
  <main class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 pb-10 pt-24">
    <!-- HERO -->
    <section class="mt-4 text-center">
      <h1 class="text-2xl sm:text-3xl font-bold tracking-tight">
        Portfólio de Aplicações
      </h1>
      <p class="mt-1 text-sm sm:text-base text-[rgb(var(--page-fg-muted))]">
        Selecione o sistema que deseja acessar:
      </p>
    </section>

    <!-- GRID de MiniApps -->
    <section
      class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5"
      aria-label="MiniApps disponíveis"
    >
      <!-- EDUCAÇÃO (ativo) -->
      <a
        href="./src/miniapps/educacao/index.html"
        class="group aspect-square relative overflow-hidden rounded-3xl border border-pink-600/40 bg-pink-500/10 backdrop-blur-sm p-5 flex flex-col hover:-translate-y-0.5 hover:border-pink-500/60 hover:bg-pink-500/15 transition"
      >
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none">
          <span
            class="material-symbols-rounded leading-none text-pink-500/30 text-[7rem] sm:text-[8rem] md:text-[9rem]"
          >
            cast_for_education
          </span>
        </div>
        <div class="relative z-10 flex items-start justify-between">
          <h2 class="text-lg font-semibold leading-tight">
            Educação
          </h2>
          <div class="inline-flex rounded-full bg-emerald-500/15 px-2 py-0.5 text-xs font-semibold text-emerald-200">
            Ativo
          </div>
        </div>
        <div class="mt-auto"></div>
        <p class="relative z-10 text-center text-sm opacity-90">
          Provas, simulados, turmas, dashboards e jornadas guiadas.
        </p>
      </a>

      <!-- FINANCEIRO (em breve) -->
      <div
        role="article"
        aria-label="Financeiro em breve"
        class="aspect-square relative overflow-hidden rounded-3xl border border-emerald-600/40 bg-emerald-500/10 backdrop-blur-sm p-5 flex flex-col opacity-70 hover:border-emerald-500/60 hover:bg-emerald-500/15 transition"
      >
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none">
          <span
            class="material-symbols-rounded leading-none text-emerald-500/30 text-[7rem] sm:text-[8rem] md:text-[9rem]"
          >
            account_balance
          </span>
        </div>
        <div class="relative z-10 flex items-start justify-between">
          <h2 class="text-lg font-semibold leading-tight">
            Financeiro
          </h2>
          <div class="inline-flex rounded-full bg-white/10 px-2 py-0.5 text-xs font-semibold">
            Em breve
          </div>
        </div>
        <div class="mt-auto"></div>
        <p class="relative z-10 text-center text-sm opacity-90">
          Fluxo de caixa, cobranças e relatórios rápidos.
        </p>
      </div>

      <!-- SAÚDE (em breve) -->
      <div
        role="article"
        aria-label="Saúde em breve"
        class="aspect-square relative overflow-hidden rounded-3xl border border-sky-600/40 bg-sky-500/10 backdrop-blur-sm p-5 flex flex-col opacity-70 hover:border-sky-500/60 hover:bg-sky-500/15 transition"
      >
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none">
          <span
            class="material-symbols-rounded leading-none text-sky-500/30 text-[7rem] sm:text-[8rem] md:text-[9rem]"
          >
            health_and_safety
          </span>
        </div>
        <div class="relative z-10 flex items-start justify-between">
          <h2 class="text-lg font-semibold leading-tight">
            Saúde
          </h2>
          <div class="inline-flex rounded-full bg-white/10 px-2 py-0.5 text-xs font-semibold">
            Em breve
          </div>
        </div>
        <div class="mt-auto"></div>
        <p class="relative z-10 text-center text-sm opacity-90">
          Registro clínico, vacinação e comunicação interna.
        </p>
      </div>

      <!-- AGENDA (em breve) -->
      <div
        role="article"
        aria-label="Agenda em breve"
        class="aspect-square relative overflow-hidden rounded-3xl border border-amber-600/40 bg-amber-400/10 backdrop-blur-sm p-5 flex flex-col opacity-70 hover:border-amber-500/60 hover:bg-amber-400/15 transition"
      >
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none select-none">
          <span
            class="material-symbols-rounded leading-none text-amber-500/30 text-[7rem] sm:text-[8rem] md:text-[9rem]"
          >
            calendar_month
          </span>
        </div>
        <div class="relative z-10 flex items-start justify-between">
          <h2 class="text-lg font-semibold leading-tight">
            Agenda
          </h2>
          <div class="inline-flex rounded-full bg-white/10 px-2 py-0.5 text-xs font-semibold">
            Em breve
          </div>
        </div>
        <div class="mt-auto"></div>
        <p class="relative z-10 text-center text-sm opacity-90">
          Calendários, eventos e lembretes em tempo real.
        </p>
      </div>
    </section>
  </main>

  <!-- TOAST DE TEMA -->
  <div
    id="theme-toast"
    class="fixed bottom-4 right-4 z-50 pointer-events-none select-none opacity-0 translate-y-2 transition-all duration-300"
    role="status"
    aria-live="polite"
  >
    <div class="flex items-center gap-2 rounded-full border border-[rgb(var(--page-border)/0.18)] bg-[rgb(var(--page-bg)/0.9)] px-3 py-1.5 text-xs font-semibold shadow-lg">
      <span id="theme-toast-icon" class="material-symbols-rounded text-base">
        dark_mode
      </span>
      <span id="theme-toast-label">
        Tema escuro
      </span>
    </div>
  </div>

  <!-- SCRIPT ÚNICO (tema + painel do usuário) -->
  <script>
    (function () {
      const THEME_KEY = "app5-theme";
      const USER_KEY = "app5-user-data";

      function applyTheme(theme, options) {
        const opts = options || {};
        const notify = opts.notify !== false;

        const html = document.documentElement;
        html.setAttribute("data-theme", theme);

        const btn = document.getElementById("theme-toggle");
        const icon = btn ? btn.querySelector(".material-symbols-rounded") : null;
        if (icon) {
          icon.textContent = theme === "dark" ? "dark_mode" : "light_mode";
        }

        const toast = document.getElementById("theme-toast");
        const toastLabel = document.getElementById("theme-toast-label");
        const toastIcon = document.getElementById("theme-toast-icon");

        if (toast && toastLabel && toastIcon && notify) {
          toastLabel.textContent = theme === "dark" ? "Tema escuro" : "Tema claro";
          toastIcon.textContent = theme === "dark" ? "dark_mode" : "light_mode";

          toast.classList.remove("opacity-0", "translate-y-2");
          toast.classList.add("opacity-100", "translate-y-0");

          clearTimeout(window.__themeToastTimeout);
          window.__themeToastTimeout = setTimeout(function () {
            toast.classList.add("opacity-0", "translate-y-2");
            toast.classList.remove("opacity-100", "translate-y-0");
          }, 1800);
        }
      }

      function initTheme() {
        var stored = null;
        try {
          stored = localStorage.getItem(THEME_KEY);
        } catch (e) {}

        var theme =
          stored === "light" || stored === "dark"
            ? stored
            : (window.matchMedia &&
               window.matchMedia("(prefers-color-scheme: dark)").matches)
            ? "dark"
            : "light";

        applyTheme(theme, { notify: false });
      }

      function toggleTheme() {
        var current = document.documentElement.getAttribute("data-theme") || "dark";
        var next = current === "dark" ? "light" : "dark";
        try {
          localStorage.setItem(THEME_KEY, next);
        } catch (e) {}
        applyTheme(next, { notify: true });
      }

      function createPhoneMask() {
        var autoCC = false;
        return function maskPhone(value) {
          var n = (value || "").replace(/\D/g, "");

          if (!autoCC && n.length >= 2 && !n.startsWith("55")) {
            n = "55" + n;
            autoCC = true;
          }

          if (n.length <= 2) return "+" + n;
          if (n.length <= 4) return "+" + n.slice(0, 2) + " " + n.slice(2);

          if (n.length <= 9) {
            var cc = n.slice(0, 2);
            var ddd = n.slice(2, 4);
            var f = n.slice(4);
            return "+" + cc + " " + ddd + " " + f;
          }

          var cc2 = n.slice(0, 2);
          var ddd2 = n.slice(2, 4);
          var first =
            n.length === 10 ? n.slice(4, 8) : n.slice(4, 9);
          var last = n.slice(-4);
          return "+" + cc2 + " " + ddd2 + " " + first + "-" + last;
        };
      }

      function loadUserData() {
        try {
          var raw = localStorage.getItem(USER_KEY);
          if (!raw) return null;
          var data = JSON.parse(raw);
          if (!data || (!data.name && !data.phone && !data.email)) return null;
          return data;
        } catch (e) {
          return null;
        }
      }

      function saveUserData(data) {
        try {
          localStorage.setItem(USER_KEY, JSON.stringify(data));
        } catch (e) {}
      }

      function clearUserData() {
        try {
          localStorage.removeItem(USER_KEY);
        } catch (e) {}
      }

      function initUserPanel() {
        var openBtn = document.getElementById("user-btn");
        var panel = document.getElementById("user-panel");
        var closeBtn = document.getElementById("user-close");
        var form = document.getElementById("user-form");
        var nameInput = document.getElementById("user-name");
        var phoneInput = document.getElementById("user-phone");
        var emailInput = document.getElementById("user-email");
        var summary = document.getElementById("user-summary");
        var status = document.getElementById("user-status");
        var deleteBtn = document.getElementById("user-delete");

        if (!openBtn || !panel) return;

        var maskPhone = createPhoneMask();

        function setStatus(text, tone) {
          if (!status) return;
          status.textContent = text;
          status.classList.remove(
            "text-emerald-400",
            "text-amber-300",
            "text-red-300"
          );
          if (tone === "ok") status.classList.add("text-emerald-400");
          if (tone === "warn") status.classList.add("text-amber-300");
          if (tone === "error") status.classList.add("text-red-300");
        }

        function renderSummary(data) {
          if (!summary) return;
          if (!data) {
            summary.innerHTML =
              '<p class="text-sm opacity-70">Nenhum dado salvo neste dispositivo ainda.</p>';
            return;
          }
          var html =
            '<ul class="text-sm space-y-1">' +
            '<li><span class="font-semibold">Nome:</span> ' +
            (data.name || "") +
            "</li>" +
            '<li><span class="font-semibold">Telefone:</span> ' +
            (data.phone || "") +
            "</li>" +
            '<li><span class="font-semibold">E-mail:</span> ' +
            (data.email || "") +
            "</li>";
          if (data.updated) {
            html +=
              '<li class="text-xs opacity-70">Atualizado em ' +
              data.updated +
              "</li>";
          }
          html += "</ul>";
          summary.innerHTML = html;
        }

        function validateName(name) {
          return name.trim().split(/\s+/).length >= 2;
        }

        function validateEmail(email) {
          if (!email) return false;
          return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function validatePhone(phone) {
          return phone.replace(/\D/g, "").length >= 10;
        }

        var existing = loadUserData();
        if (existing) {
          if (nameInput) nameInput.value = existing.name || "";
          if (phoneInput) phoneInput.value = existing.phone || "";
          if (emailInput) emailInput.value = existing.email || "";
          renderSummary(existing);
          setStatus("Dados restaurados a partir deste dispositivo.", "ok");
        } else {
          renderSummary(null);
          setStatus(
            "Preencha seus dados para salvá-los neste dispositivo.",
            "warn"
          );
        }

        openBtn.addEventListener("click", function () {
          panel.classList.remove("hidden");
          panel.classList.add("flex");
        });

        if (closeBtn) {
          closeBtn.addEventListener("click", function () {
            panel.classList.add("hidden");
            panel.classList.remove("flex");
          });
        }

        panel.addEventListener("click", function (e) {
          if (e.target === panel) {
            panel.classList.add("hidden");
            panel.classList.remove("flex");
          }
        });

        if (phoneInput) {
          phoneInput.addEventListener("input", function () {
            phoneInput.value = maskPhone(phoneInput.value);
          });
        }

        if (form) {
          form.addEventListener("submit", function (e) {
            e.preventDefault();

            var name = (nameInput.value || "").trim();
            var phone = (phoneInput.value || "").trim();
            var email = (emailInput.value || "").trim();

            var maskedPhone = maskPhone(phone);
            phoneInput.value = maskedPhone;

            if (!validateName(name)) {
              setStatus(
                "Informe seu nome completo (nome e sobrenome).",
                "warn"
              );
              return;
            }
            if (!validatePhone(maskedPhone)) {
              setStatus("Informe um telefone válido com DDD.", "warn");
              return;
            }
            if (!validateEmail(email)) {
              setStatus("Informe um e-mail válido.", "warn");
              return;
            }

            var data = {
              name: name,
              phone: maskedPhone,
              email: email,
              updated: new Date().toLocaleString("pt-BR"),
            };

            saveUserData(data);
            renderSummary(data);
            setStatus("Dados salvos neste dispositivo.", "ok");
          });
        }

        if (deleteBtn) {
          deleteBtn.addEventListener("click", function () {
            if (
              !confirm(
                "Tem certeza que deseja remover seus dados deste dispositivo?"
              )
            )
              return;
            clearUserData();
            if (nameInput) nameInput.value = "";
            if (phoneInput) phoneInput.value = "";
            if (emailInput) emailInput.value = "";
            renderSummary(null);
            setStatus("Dados removidos deste dispositivo.", "error");
          });
        }
      }

      document.addEventListener("DOMContentLoaded", function () {
        initTheme();
        var themeToggle = document.getElementById("theme-toggle");
        if (themeToggle) {
          themeToggle.addEventListener("click", toggleTheme);
        }
        initUserPanel();
      });
    })();
  </script>
</body>
</html>
