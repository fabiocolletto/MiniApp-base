<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>5 Horas – MiniApp</title>
  <link rel="stylesheet" href="./docs/global/shell.css">
  <script type="importmap">
  {
    "imports": {
      "single-spa": "https://cdn.jsdelivr.net/npm/single-spa@latest/lib/esm/single-spa.min.js"
    }
  }
  </script>
</head>
<body class="shell">
  <header class="shell-header">
    <button onclick="navegar('/home')">Home</button>
    ...
  </header>
  <div id="app-root">Carregando aplicação...</div>

  <script>
    function navegar(path) {
      window.history.pushState({}, '', path);
      window.dispatchEvent(new PopStateEvent('popstate'));
    }
  </script>

  <script type="module">
    import { registerApplication, start } from 'single-spa';

    // Altere BASE conforme a estrutura real do repo:
    const BASE = './miniapps'; // <-- <--- ajuste conforme necessário

    const loader = async (relPath) => {
      const localUrl = `${BASE}/${relPath}`;
      const cdnUrl = `https://cdn.jsdelivr.net/gh/fabiocolletto/miniapp/${BASE}/${relPath}`;

      try {
        console.log('[5H] tentando local:', localUrl);
        return await import(localUrl);
      } catch (e1) {
        console.warn('[5H] local falhou, tentando CDN:', cdnUrl, e1);
        return await import(cdnUrl);
      }
    };

    registerApplication({ name: '5horas-home', app: () => loader('home/Home.js'), activeWhen: loc => loc.pathname === '/' || loc.pathname === '/home' });
    // ... outros apps ...

    start();
  </script>
</body>
</html>
