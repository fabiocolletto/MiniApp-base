<!DOCTYPE html>
<html lang="pt-BR" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MiniApp - Configurações do Sistema</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <link rel="stylesheet" href="https://unpkg.com/open-props@1.6.18/open-props.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Sharp" rel="stylesheet">

    <link rel="stylesheet" href="../../docs/miniapp-global.css">
    <link rel="stylesheet" href="../../docs/miniapp-card.css">

    <style>
        .settings-memory-grid {
            display: grid;
            gap: 1.5rem;
            align-items: stretch;
            justify-items: stretch;
        }

        .memory-summary-card {
            width: 100%;
            max-width: 320px;
            cursor: pointer;
            transition: transform 0.25s ease, box-shadow 0.25s ease;
            justify-self: center;
        }

        .memory-summary-card:focus-visible {
            outline: 3px solid var(--app-accent, #38bdf8);
            outline-offset: 4px;
        }

        .memory-summary-card[data-expanded="true"] .memory-arrow {
            transform: rotate(90deg);
        }

        .memory-arrow {
            transition: transform 0.25s ease;
        }

        .memory-detail-panel {
            width: 100%;
            max-width: 780px;
        }

        .memory-detail-panel[hidden] {
            display: none;
        }

        @media (min-width: 768px) {
            .memory-summary-card {
                justify-self: start;
            }
        }

        @media (min-width: 1024px) {
            .settings-memory-grid {
                grid-template-columns: minmax(260px, 320px) minmax(0, 1fr);
                align-items: start;
            }

            .memory-summary-card {
                max-width: none;
            }

            .memory-detail-panel {
                display: block !important;
            }
        }

    </style>

    <script type="module" src="../../docs/components/app-shared-footer.js"></script>

    <meta name="theme-color" content="#0f172a">
</head>
<body class="app-shell">
    <main id="app-main" class="app-main">
        <section class="responsive-panel-grid">
            <article id="config-card" class="miniapp-card">
                <header class="miniapp-card-header">
                    <h2 class="miniapp-card-title">Configurações do sistema</h2>
                    <p class="miniapp-card-subtitle">
                        Monitoramento do uso de memória do IndexedDB e estado da sincronização local.
                    </p>
                </header>

                <div class="miniapp-card-body">
                    <div class="settings-memory-grid" aria-live="polite">
                        <button
                            id="indexeddb-card"
                            class="memory-summary-card miniapp-card border border-slate-800 bg-slate-900 text-left"
                            type="button"
                            aria-expanded="false"
                            aria-controls="memory-detail-panel"
                        >
                            <div class="flex items-start justify-between gap-4">
                                <div>
                                    <p class="text-xs uppercase tracking-widest text-slate-400">IndexedDB</p>
                                    <h3 class="text-xl font-semibold text-white">Memória local</h3>
                                </div>
                                <span class="memory-arrow material-icons-sharp text-slate-400" aria-hidden="true">chevron_right</span>
                            </div>
                            <dl class="mt-6 space-y-2 text-sm">
                                <div class="flex justify-between text-slate-300">
                                    <dt>Uso atual</dt>
                                    <dd id="memory-usage">--</dd>
                                </div>
                                <div class="flex justify-between text-slate-300">
                                    <dt>Status</dt>
                                    <dd id="memory-status">Coletando dados...</dd>
                                </div>
                                <div class="flex justify-between text-slate-300">
                                    <dt>Memória livre</dt>
                                    <dd id="memory-free">--</dd>
                                </div>
                            </dl>
                            <p class="mt-6 text-xs text-slate-500">
                                Toque para abrir o painel detalhado e acompanhar a capacidade total do navegador.
                            </p>
                        </button>

                        <section
                            id="memory-detail-panel"
                            class="memory-detail-panel miniapp-card bg-slate-900 border border-slate-800"
                            hidden
                        >
                            <div class="miniapp-card-header">
                                <p class="miniapp-card-subtitle text-slate-400">Detalhamento em tempo real</p>
                                <h3 class="miniapp-card-title">Uso da célula IndexedDB</h3>
                            </div>
                            <div class="miniapp-card-body space-y-6">
                                <p class="text-sm text-slate-300">
                                    Os dados abaixo utilizam a API <code>StorageManager.estimate()</code> para calcular quanto
                                    espaço do navegador está disponível para o IndexedDB desta PWA.
                                </p>

                                <div>
                                    <p class="text-xs uppercase tracking-widest text-slate-400 mb-2">Percentual ocupado</p>
                                    <div class="h-2 rounded-full bg-slate-800 overflow-hidden">
                                        <div id="memory-progress" class="h-full bg-sky-400" style="width: 0%;"></div>
                                    </div>
                                </div>

                                <dl class="grid gap-4 sm:grid-cols-2 text-sm text-slate-200">
                                    <div>
                                        <dt class="text-slate-400 text-xs uppercase tracking-widest">Capacidade total</dt>
                                        <dd id="memory-quota" class="text-lg font-semibold">--</dd>
                                    </div>
                                    <div>
                                        <dt class="text-slate-400 text-xs uppercase tracking-widest">Uso calculado</dt>
                                        <dd id="memory-usage-detail" class="text-lg font-semibold">--</dd>
                                    </div>
                                    <div>
                                        <dt class="text-slate-400 text-xs uppercase tracking-widest">Memória livre</dt>
                                        <dd id="memory-free-detail" class="text-lg font-semibold">--</dd>
                                    </div>
                                    <div>
                                        <dt class="text-slate-400 text-xs uppercase tracking-widest">Última atualização</dt>
                                        <dd id="memory-updated" class="text-lg font-semibold">--</dd>
                                    </div>
                                </dl>

                                <div class="rounded-md border border-slate-800 bg-slate-950/70 p-4 text-sm text-slate-300">
                                    <p class="font-semibold text-white">Como interpretar:</p>
                                    <ul class="mt-2 list-disc space-y-1 pl-5">
                                        <li><strong>Estável</strong> indica que menos de 60% da cota está sendo utilizada.</li>
                                        <li><strong>Atenção</strong> aparece entre 60% e 80%.</li>
                                        <li><strong>Crítico</strong> indica necessidade de limpeza imediata.</li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                    </div>

                </div>
            </article>
        </section>
    </main>

    <app-shared-footer show-settings="true" active-tab="settings" state="collapsed"></app-shared-footer>

    <script type="module" src="./config-control.js"></script>
</body>
</html>
